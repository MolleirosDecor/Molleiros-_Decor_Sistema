<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Molleiros Decor | Sistema Profissional</title>

<!-- Supabase -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
body{
  font-family:Segoe UI,Arial,sans-serif;
  background:#fff7fb;
  margin:0;
  color:#555;
}

/* LOGIN */
#loginBox{
  max-width:400px;
  margin:100px auto;
  background:#fff;
  padding:30px;
  border-radius:18px;
  box-shadow:0 0 15px rgba(0,0,0,.1);
}
#loginBox h2{color:#c64f86;text-align:center}
label{display:block;margin-top:12px}
input{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:1px solid #ddd;
}
button{
  background:#f8c8dc;
  border:none;
  padding:12px;
  border-radius:12px;
  margin-top:15px;
  cursor:pointer;
  width:100%;
}
button:hover{background:#f4b3cd}

/* SISTEMA */
header{
  background:#f8c8dc;
  padding:15px;
  text-align:center;
}
section{
  background:#fff;
  max-width:1200px;
  margin:20px auto;
  padding:20px;
  border-radius:18px;
  box-shadow:0 0 12px rgba(0,0,0,.06);
}
h2{color:#c64f86}
table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}
th,td{
  border:1px solid #eee;
  padding:8px;
}
th{background:#fff1c1}
.total{
  font-size:22px;
  color:#c64f86;
  font-weight:bold;
  margin-top:15px;
}
.flex{display:flex;gap:12px;flex-wrap:wrap}
.flex>div{flex:1}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="loginBox">
  <h2>ğŸ” Login Molleiros Decor</h2>

  <label>Email</label>
  <input id="loginEmail" type="email" value="molleirosdecor@gmail.com">

  <label>Senha</label>
  <input id="loginSenha" type="password">

  <button onclick="login()">Entrar</button>
</div>

<!-- SISTEMA -->
<div id="sistema" style="display:none">

<header>
  <h2>Molleiros Decor â€” Sistema de LocaÃ§Ã£o</h2>
</header>

<section>
  <h2>ğŸ‘© Cliente</h2>
  <div class="flex">
    <div><label>Nome</label><input id="nome"></div>
    <div><label>CPF</label><input id="cpf"></div>
    <div><label>Telefone</label><input id="telefone"></div>
  </div>
  <label>EndereÃ§o</label>
  <input id="endereco">
</section>

<section>
  <h2>ğŸ“¦ Itens Locados (Checklist)</h2>
  <div class="flex">
    <div><label>Item</label><input id="item"></div>
    <div><label>Qtd</label><input type="number" id="qtd"></div>
    <div><label>Valor (avaria/extravio)</label><input type="number" id="valor"></div>
  </div>
  <button onclick="addItem()">Adicionar Item</button>

  <table id="tItens">
    <tr><th>âœ”</th><th>Item</th><th>Qtd</th><th>Valor</th></tr>
  </table>
</section>

<section>
  <h2>ğŸ’° Valores</h2>
  <div class="flex">
    <div><label>Valor do Contrato</label><input type="number" id="valorContrato" oninput="recalcular()"></div>
    <div><label>Sinal Recebido</label><input type="number" id="sinal" oninput="recalcular()"></div>
  </div>
  <div class="total" id="total">Valor a receber: R$ 0,00</div>
</section>

<section>
  <button onclick="imprimir()">ğŸ–¨ï¸ Imprimir Contrato</button>
</section>

</div>

<script>
// ğŸ”— SUPABASE (SUAS CHAVES)
const supabaseUrl = 'https://dpwtogyfwxoibtrrquax.supabase.co';
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRwd3RvZ3lmd3hvaWJ0cnJxdWF4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc4MzMyOTUsImV4cCI6MjA4MzQwOTI5NX0.VkDX_uXY2qPFtnEqLFULjRUrN4dACJE86AcawIXZ-44';

const supabase = supabase.createClient(supabaseUrl, supabaseKey);

// ğŸ” LOGIN
async function login(){
  const email = loginEmail.value;
  const senha = loginSenha.value;

  const { error } = await supabase.auth.signInWithPassword({
    email: email,
    password: senha
  });

  if(error){
    alert('Erro no login: ' + error.message);
    return;
  }

  loginBox.style.display = 'none';
  sistema.style.display = 'block';
}

// ğŸ” AUTO LOGIN
supabase.auth.getSession().then(({ data })=>{
  if(data.session){
    loginBox.style.display='none';
    sistema.style.display='block';
  }
});

// ğŸ“¦ ITENS
let itens=[];
function addItem(){
  itens.push({
    item:item.value,
    qtd:qtd.value,
    valor:valor.value
  });

  tItens.innerHTML += `
   <tr>
     <td><input type="checkbox"></td>
     <td>${item.value}</td>
     <td>${qtd.value}</td>
     <td>R$ ${Number(valor.value).toFixed(2)}</td>
   </tr>
  `;

  item.value=qtd.value=valor.value='';
}

// ğŸ’° VALORES
function recalcular(){
  let v = Number(valorContrato.value)||0;
  let s = Number(sinal.value)||0;
  let receber = v - s;
  total.innerText = 'Valor a receber: R$ ' + receber.toFixed(2);
}

// ğŸ–¨ï¸ IMPRIMIR
function imprimir(){
  window.print();
}
</script>

</body>
</html>
